os: linux
language: node_js
node_js: '10'
sudo: false
dist: trusty
jobs:
  include:
    - stage: test all
      script: npm run test:e2e
    - stage: test single
      script: npm run test:e2e_single_file
before_install:
  - sudo apt-get clean
  - sudo apt-get update
  - sudo apt-get install -y dpkg
  - sudo apt-get install -y libxml2-dev
  - wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
  - sudo dpkg -i google-chrome-stable_current_amd64.deb
  - npm run install:e2e
before_script:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start &
  - sleep 3
  - google-chrome --product-version
  - webdriver-manager update --versions.chrome 77.0.3865.40
  - export PATH=/home/travis/.nvm/versions/node/v10.16.3/lib/node_modules/webdriver-manager/selenium/chromedriver_77.0.3865.40:$PATH